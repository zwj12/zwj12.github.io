---
layout: post
title: "MFC MDI"
date: 2022-07-06 19:23:00 +0800
author: Michael
categories: CPP
---

# Docking Pane
Can be unchecked.  

| Pane | Header | Class | Description |
|:-----------|:-----------|:-----------|:-----------|
| Properties | PropertiesWnd.h | CPropertiesToolBar(CMFCToolBar), CPropertiesWnd(CDockablePane) | |
| Output | OutputWnd.h | COutputList(CListBox), COutputWnd(CDockablePane) | |
| Explorer | ViewTree.h | CViewTree(CTreeCtrl) | |
| Class | ClassView.h | CClassToolBar(CMFCToolBar), CClassView(CDockablePane) | |
| Class | FileView.h | CFileViewToolBar(CMFCToolBar), CFileView(CDockablePane) | |

![日志文件夹](/assets/cpp/DockingPane.png)  

# Application Look
Can be unchecked.  

	CMFCVisualManager::SetDefaultManager(RUNTIME_CLASS(CMFCVisualManagerVS2008));
![日志文件夹](/assets/cpp/ApplicationLook.png)  

# Menu Printing
No need to unchecked.  

![日志文件夹](/assets/cpp/MenuPrinting.png)  

# Tabbed Documents & Ribbon
No need to unchecked. 
![日志文件夹](/assets/cpp/TabbedDocumentsRibbon.png)  

# Menu Style
No need to unchecked.  
![日志文件夹](/assets/cpp/MenuStyle.png)  

# MFC Standard Style & Old MFC Class
当使用MFC classic Menu时，MFC向导创建的工程会使用MFC旧类，而非VS2008后发布的MFC新类，例如使用CWinApp而非CwinAppEx，使用CMDIFrameWnd类而非使用CMDIFrameWndEx类。

    int CMainFrame::OnCreate(LPCREATESTRUCT lpCreateStruct)
    {
        if (CMDIFrameWnd::OnCreate(lpCreateStruct) == -1)
            return -1;

        if (!m_wndToolBar.CreateEx(this, TBSTYLE_FLAT, WS_CHILD | WS_VISIBLE | CBRS_TOP | CBRS_GRIPPER | CBRS_TOOLTIPS | CBRS_FLYBY | CBRS_SIZE_DYNAMIC) ||
            !m_wndToolBar.LoadToolBar(IDR_MAINFRAME))
        {
            TRACE0("Failed to create toolbar\n");
            return -1;      // fail to create
        }

        if (!m_wndStatusBar.Create(this))
        {
            TRACE0("Failed to create status bar\n");
            return -1;      // fail to create
        }
        m_wndStatusBar.SetIndicators(indicators, sizeof(indicators)/sizeof(UINT));

        // TODO: Delete these three lines if you don't want the toolbar to be dockable
        m_wndToolBar.EnableDocking(CBRS_ALIGN_ANY);
        EnableDocking(CBRS_ALIGN_ANY);
        DockControlBar(&m_wndToolBar);


        return 0;
    }

![日志文件夹](/assets/cpp/MFCStandardStyle.png)  